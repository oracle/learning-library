{"paragraphs":[{"title":"Divide data for training, validation and testing","text":"%script\n-- Drop any previously existing  table for notebook repeatability\nBEGIN\n      EXECUTE IMMEDIATE 'DROP Table SSW_T';\n      EXECUTE IMMEDIATE 'DROP Table SSW_V';\n      EXECUTE IMMEDIATE 'DROP Table SSW_P';\n  EXCEPTION\n      WHEN OTHERS THEN NULL;\nEND;\n/\n\n-- Training data\nCreate table SSW_T as SELECT a.last_reported, a.STATIONID, a.TIME_INT, a.WEEKDAY_INT, a.TOTALDOCKS, a.AVAILABLEBIKES, a.STATUSVALUE, a.ACTIVITY, a.TRUACTIVITY, a.NOAVAILABLEBIKES, a.NOAVAILABLEDOCKS, a.AVG_TEMP, a.MIN_TEMP, a.MAX_TEMP, a.AVG_DEWPOINT, a.WIND_SPEED, a.WIND_DIRECTION, a.WIND_PERCENT, b.BOROUGHCODE, b.REGION_ID\n    FROM Admin.STATION_STATUS_WEATHER a, Admin.STATION_INFO b\n    WHERE a.STATIONID = b.STATION_ID and a.last_reported >= '12-AUG-17' and a.LAST_REPORTED < '28-AUG-17' ;\n\n-- Validation data\nCreate table SSW_V as SELECT a.last_reported, a.STATIONID, a.TIME_INT, a.WEEKDAY_INT, a.TOTALDOCKS, a.AVAILABLEBIKES, a.STATUSVALUE, a.ACTIVITY, a.TRUACTIVITY, a.NOAVAILABLEBIKES, a.NOAVAILABLEDOCKS, a.AVG_TEMP, a.MIN_TEMP, a.MAX_TEMP, a.AVG_DEWPOINT, a.WIND_SPEED, a.WIND_DIRECTION, a.WIND_PERCENT, b.BOROUGHCODE, b.REGION_ID\n    FROM Admin.Station_Status_weather a, Admin.Station_Info b\n    WHERE a.STATIONID = b.STATION_ID and a.last_reported >= '28-AUG-17' and a.last_reported < '31-AUG-17' ;\n\n-- Prediction data\nCreate table SSW_P as SELECT a.last_reported, a.STATIONID, a.TIME_INT, a.WEEKDAY_INT, a.TOTALDOCKS, a.STATUSVALUE, a.ACTIVITY, a.TRUACTIVITY, a.NOAVAILABLEBIKES, a.NOAVAILABLEDOCKS, a.AVG_TEMP, a.MIN_TEMP, a.MAX_TEMP, a.AVG_DEWPOINT, a.WIND_SPEED, a.WIND_DIRECTION, a.WIND_PERCENT, b.BOROUGHCODE, b.REGION_ID\n    FROM Admin.Station_Status_weather a, Admin.Station_Info b\n    where a.STATIONID = b.STATION_ID and a.last_reported >= '31-AUG-17' ;\n\nSELECT COUNT(*) FROM SSW_T;\nSELECT COUNT(*) FROM SSW_V;\nSELECT COUNT(*) FROM SSW_P;","user":"NAVID","dateUpdated":"2018-12-14T00:48:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n\nTable SSW_T created.\n\n\n---------------------------\n\nTable SSW_V created.\n\n\n---------------------------\n\nTable SSW_P created.\n\n\n---------------------------\nCOUNT(*)   \n    685371 \n\n\n\n---------------------------\nCOUNT(*)   \n    129571 \n\n\n\n---------------------------\nCOUNT(*)   \n     81198 \n\n\n\n---------------------------\n"}]},"jobName":"paragraph_1544479443485_1136788492","id":"20181210-220403_785122698","dateCreated":"2018-10-17T16:33:51+0000","dateStarted":"2018-12-13T19:27:26+0000","dateFinished":"2018-12-13T19:27:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"focus":true,"$$hashKey":"object:1288"},{"title":"Delete existing tables","text":"%script\nDECLARE\n     CURSOR v_stationIDRecords IS\n          select unique station_id from Admin.Station_Info order by station_id;\n         idx  Admin.Station_Info%ROWTYPE;\n-- Drop any previously existing  table for notebook repeatability\nbegin\n    for idx in v_stationIDRecords loop\n        execute immediate 'Drop table SSW_T_'|| idx.station_id ||'';\n        execute immediate 'Drop table SSW_V_'|| idx.station_id ||'';\n        execute immediate 'Drop table SSW_P_'|| idx.station_id ||'';\n    end loop;\n    EXCEPTION\n         WHEN OTHERS THEN NULL;\nend;  \n/","user":"NAVID","dateUpdated":"2018-12-14T00:48:13+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/plsql","results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"tableHide":true,"editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n"}]},"jobName":"paragraph_1544479443485_1646048183","id":"20181210-220403_167086223","dateCreated":"2018-10-17T15:41:48+0000","dateStarted":"2018-12-13T18:48:54+0000","dateFinished":"2018-12-13T18:49:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:1289"},{"title":"Partition data","text":"%script\nDECLARE\n     CURSOR v_stationIDRecords IS\n          select unique station_id from Admin.Station_Info order by station_id;\n         idx  Admin.Station_Info%ROWTYPE;\nbegin\n    for idx in v_stationIDRecords loop\n        execute immediate \n            'Create table SSW_T_'|| idx.station_id ||' AS  \n                Select * FROM SSW_T t Where t.stationid = '''|| idx.station_id ||'''';\n        execute immediate \n            'Create table SSW_V_'|| idx.station_id ||' AS  \n                Select * FROM SSW_V t Where t.stationid = '''|| idx.station_id ||'''';\n        execute immediate \n            'Create table SSW_P_'|| idx.station_id ||' AS  \n                Select * FROM SSW_P t Where t.stationid = '''|| idx.station_id ||'''';\n    end loop;\nend;  \n/","user":"NAVID","dateUpdated":"2018-12-14T00:48:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true,"tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n"}]},"jobName":"paragraph_1544479443485_-1503648392","id":"20181210-220403_1915960970","dateCreated":"2018-10-17T15:55:44+0000","dateStarted":"2018-12-13T21:04:39+0000","dateFinished":"2018-12-13T21:13:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:1290"},{"title":"Drop existing models","text":"%script \nDECLARE\n     CURSOR v_stationIDRecords IS\n          select unique station_id from Admin.Station_Info order by station_id;\n    idx  Admin.Station_Info%ROWTYPE;\n    modelName varchar2(40);      \n         \nBEGIN\n    for idx in v_stationIDRecords loop\n        modelName := concat(concat('GLMR_Station_' , idx.station_id), '_BIKEAVAIL_REGR') ;\n        --dbms_output.put_line(modelName); \n        DBMS_DATA_MINING.DROP_MODEL(model_name => modelName);\n    end loop;\n    EXCEPTION WHEN OTHERS THEN NULL; \nEND;\n/\n\n-- Clean up and drop any previous GLM Model Settings table for notebook repeatability\nBEGIN EXECUTE IMMEDIATE 'DROP TABLE glmr_BikeAvail_settings';\nEXCEPTION WHEN OTHERS THEN NULL; END;\n/\n\n-- Clean up and drop any previous Model Diagnostics table for notebook repeatability\nBEGIN EXECUTE IMMEDIATE 'DROP TABLE glmr_BikeAvail_diag';\nEXCEPTION WHEN OTHERS THEN NULL; END;\n/","user":"NAVID","dateUpdated":"2018-12-13T18:49:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true,"tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n"}]},"jobName":"paragraph_1544479443485_-960907767","id":"20181210-220403_787293523","dateCreated":"2018-10-17T16:54:34+0000","dateStarted":"2018-12-13T18:49:13+0000","dateFinished":"2018-12-13T18:53:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:1291"},{"title":"Modify the model setting","text":"%script \n\nCREATE TABLE glmr_BikeAvail_settings (\n  setting_name  VARCHAR2(30),\n  setting_value VARCHAR2(4000));\n  \nBEGIN \n-- Populate settings table\n  INSERT INTO glmr_BikeAvail_settings (setting_name, setting_value) VALUES\n    (dbms_data_mining.algo_name, dbms_data_mining.algo_generalized_linear_model);\n  -- output row diagnostic statistics into a table named GLMC_SH_SAMPLE_DIAG  \n  INSERT INTO  glmr_BikeAvail_settings (setting_name, setting_value) VALUES\n    (dbms_data_mining.glms_diagnostics_table_name, 'GLMR_BikeAvail_DIAG');  \n  INSERT INTO  glmr_BikeAvail_settings (setting_name, setting_value) VALUES\n    (dbms_data_mining.prep_auto, dbms_data_mining.prep_auto_on);  \n  -- turn on feature selection\n  INSERT INTO  glmr_BikeAvail_settings (setting_name, setting_value) VALUES  \n    (dbms_data_mining.glms_ftr_selection, \n    dbms_data_mining.glms_ftr_selection_enable);\n  -- turn on feature generation\n  INSERT INTO  glmr_BikeAvail_settings (setting_name, setting_value) VALUES \n    (dbms_data_mining.glms_ftr_generation, \n    dbms_data_mining.glms_ftr_generation_enable); \nEND;\n","user":"NAVID","dateUpdated":"2018-12-13T18:54:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true,"tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nTable GLMR_BIKEAVAIL_SETTINGS created.\n\n\n---------------------------\n\nPL/SQL procedure successfully completed.\n\n"}]},"jobName":"paragraph_1544479443485_-1581690437","id":"20181210-220403_1615041873","dateCreated":"2018-10-17T15:53:14+0000","dateStarted":"2018-12-13T18:54:22+0000","dateFinished":"2018-12-13T18:54:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:1292"},{"title":"Apply the model","text":"%script\n\ndeclare\n    CURSOR v_stationIDRecords IS\n          select unique station_id from Admin.Station_Info order by station_id;\n    idx  Admin.Station_Info%ROWTYPE;\n    m_name varchar2(40);\n    table_name varchar2(16);\n    id_col varchar2(16);\n    target_col varchar2(16);\n    setting_tab varchar2(24);\n    func varchar2(40);\n    v_xlst dbms_data_mining_transform.TRANSFORM_LIST;\n \nBEGIN\n    id_col := 'last_reported';\n    target_col := 'AVAILABLEBIKES';\n    setting_tab := 'glmr_BikeAvail_settings';\n    func := 'dbms_data_mining.regression';\n    for idx in v_stationIDRecords loop\n        m_name := concat(concat('GLMR_Station_' , idx.station_id), '_BikeAvail_Regr') ;\n        table_name := concat('SSW_T_' , idx.station_id);\n        DBMS_DATA_MINING.CREATE_MODEL(\n            model_name          => m_name ,\n            mining_function     => dbms_data_mining.regression ,\n            data_table_name     => table_name ,\n            case_id_column_name => id_col,\n            target_column_name  => target_col,\n            settings_table_name => setting_tab,\n            xform_list          => v_xlst);\n    end loop;        \nEND;","user":"NAVID","dateUpdated":"2018-12-13T19:36:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","tableHide":false,"title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n"}]},"jobName":"paragraph_1544479443485_2135869272","id":"20181210-220403_1171773478","dateCreated":"2018-10-17T15:53:50+0000","dateStarted":"2018-12-13T19:36:53+0000","dateFinished":"2018-12-13T20:06:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:1293"},{"title":"Drop existing result tables","text":"%script\n-- Drop any previously existing  table for notebook repeatability\nBEGIN\n      EXECUTE IMMEDIATE 'DROP Table SSW_V_RES';\n      EXECUTE IMMEDIATE 'DROP Table SSW_P_RES';\n  EXCEPTION\n      WHEN OTHERS THEN NULL;\nEND;\n/\n\nCREATE TABLE SSW_V_RES\n( LAST_REPORTED DATE,\n  STATIONID NUMBER(6,0),\n  TIME_INT NUMBER(6,0),\n  WEEKDAY_INT NUMBER(3,0),\n  TOTAL_DOCKS NUMBER(4,0),\n  ACTUAL_AVAILABLE_BIKES NUMBER(3,0),\n  PREDICTED_AVAILABLE_BIKES NUMBER(5,2)\n);\n\nCREATE TABLE SSW_P_RES\n( LAST_REPORTED DATE,\n  STATIONID NUMBER(6,0),\n  TIME_INT NUMBER(6,0),\n  WEEKDAY_INT NUMBER(3,0),\n  TOTAL_DOCKS NUMBER(4,0),\n  PREDICTED_AVAILABLE_BIKES NUMBER(5,2)\n);\n","user":"NAVID","dateUpdated":"2018-12-13T20:07:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true,"tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n\nTable SSW_V_RES created.\n\n\n---------------------------\n\nTable SSW_P_RES created.\n\n\n---------------------------\n"}]},"jobName":"paragraph_1544479443485_2080701169","id":"20181210-220403_779843960","dateCreated":"2018-10-17T17:27:02+0000","dateStarted":"2018-12-13T20:07:04+0000","dateFinished":"2018-12-13T20:07:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:1294"},{"title":"Validation","text":"%script\nDECLARE\n     CURSOR v_stationIDRecords IS\n          select unique station_id from Admin.Station_Info order by station_id;\n     idx  Admin.Station_Info%ROWTYPE;\n     modelName varchar2(40);\nbegin\n    for idx in v_stationIDRecords loop\n        modelName := concat(concat('GLMR_Station_' , idx.station_id), '_BikeAvail_Regr') ;\n        execute immediate \n            'INSERT INTO SSW_V_RES\n            (last_reported, STATIONID, TIME_INT, WEEKDAY_INT, TOTAL_DOCKS, ACTUAL_AVAILABLE_BIKES, PREDICTED_AVAILABLE_BIKES)\n            Select LAST_REPORTED, STATIONID, TIME_INT, WEEKDAY_INT, TOTALDOCKS, AVAILABLEBIKES, PREDICTION('|| modelName ||' USING *) pr \n            FROM SSW_V_'|| idx.station_id ||'';\n    end loop;\nend;\n","user":"NAVID","dateUpdated":"2018-12-13T20:07:07+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"TIME_INT","index":2,"aggr":"sum"}],"groups":[],"values":[]},"helium":{}}},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n"}]},"jobName":"paragraph_1544479443485_170208661","id":"20181210-220403_1778058841","dateCreated":"2018-10-17T18:44:00+0000","dateStarted":"2018-12-13T20:07:07+0000","dateFinished":"2018-12-13T20:07:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:1295"},{"title":"Prediction","text":"%script\nDECLARE\n     CURSOR v_stationIDRecords IS\n          select unique station_id from Admin.Station_Info order by station_id;\n     idx  Admin.Station_Info%ROWTYPE;\n     model_name varchar2(40);\nbegin\n    for idx in v_stationIDRecords loop\n    model_name := concat(concat('GLMR_Station_' , idx.station_id), '_BikeAvail_Regr') ;\n        execute immediate \n            'INSERT INTO SSW_P_RES\n            (LAST_REPORTED, STATIONID, TIME_INT, WEEKDAY_INT, TOTAL_DOCKS, PREDICTED_AVAILABLE_BIKES)\n            Select last_reported, STATIONID, TIME_INT, WEEKDAY_INT, TOTALDOCKS, PREDICTION('|| model_name ||' USING *) pr \n            FROM SSW_P_'|| idx.station_id ||'';\n    end loop;\nend;\n\n","user":"NAVID","dateUpdated":"2018-12-13T21:23:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n"}]},"jobName":"paragraph_1544479443485_1251092720","id":"20181210-220403_359595818","dateCreated":"2018-10-17T19:04:54+0000","dateStarted":"2018-12-13T21:23:12+0000","dateFinished":"2018-12-13T21:23:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:1296"},{"title":"Model statistics","text":"%script\n-- Drop any previously existing  table for notebook repeatability\nBEGIN\n      EXECUTE IMMEDIATE 'DROP Table Station_Model_RSQ';\n      EXECUTE IMMEDIATE 'DROP Table Station_Model_RSQ_TEMP';\n  EXCEPTION\n      WHEN OTHERS THEN NULL;\nEND;\n/\n\nCREATE TABLE Station_Model_RSQ_TEMP\n(\n  STATION_ID NUMBER(6,0),\n  STATION_NAME VARCHAR2(40),\n  RSQ NUMBER(12,6),\n  stat_name VARCHAR2(40)\n);\n\nDECLARE\n     CURSOR v_stationIDRecords IS\n          select unique station_id from Admin.Station_Info order by station_id;\n     idx  Admin.Station_Info%ROWTYPE;\n     model_name varchar2(40);\nbegin\n    for idx in v_stationIDRecords loop\n    model_name := concat(concat('GLMR_STATION_' , idx.station_id), '_BIKEAVAIL_REGR') ;\n        execute immediate \n            'INSERT INTO Station_Model_RSQ_TEMP\n            (STATION_ID, STATION_NAME, RSQ, stat_name)\n            Select a.station_id, a.station_name, f.numeric_value, f.NAME\n            FROM Admin.station_info a, DM$VG'|| model_name ||' f \n            where a.station_id = '|| idx.station_id ||'';\n    end loop;\nend;\n/\n\nCREATE TABLE Station_Model_RSQ\n(\n  STATION_ID NUMBER(6,0),\n  STATION_NAME VARCHAR2(40),\n  RSQ NUMBER(12,6)\n);\n\nINSERT INTO Station_Model_RSQ (STATION_ID, STATION_NAME, RSQ)\n            select STATION_ID, STATION_NAME, RSQ from Station_Model_RSQ_TEMP where stat_name = 'R_SQ';\n            \nDROP TABLE Station_Model_RSQ_TEMP;","user":"NAVID","dateUpdated":"2018-12-13T20:08:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true,"tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n\nTable STATION_MODEL_RSQ_TEMP created.\n\n\n---------------------------\n\nPL/SQL procedure successfully completed.\n\n\n---------------------------\n\nTable STATION_MODEL_RSQ created.\n\n\n---------------------------\n\n450 rows inserted.\n\n\n---------------------------\n\nTable STATION_MODEL_RSQ_TEMP dropped.\n\n\n---------------------------\n"}]},"jobName":"paragraph_1544479443485_1965451713","id":"20181210-220403_1854079817","dateCreated":"2018-10-17T19:20:21+0000","dateStarted":"2018-12-13T20:07:58+0000","dateFinished":"2018-12-13T20:08:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":true,"$$hashKey":"object:1297"},{"text":"%script\n","user":"NAVID","dateUpdated":"2018-12-13T21:50:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1544737829066_1466242514","id":"20181213-215029_830137470","dateCreated":"2018-12-13T21:50:29+0000","status":"READY","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:1298"}],"name":"Bike Share Availability Prediction","id":"95318","angularObjects":{"MDW381939C745:shared_process":[],"ORA2335BBD763:shared_process":[],"ORAE3EDEB83DF:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}