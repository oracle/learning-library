drop table STATION_ST_WTH_TRAINING;
drop table STATION_ST_WTH_VALIDATING;
drop table STATION_ST_WTH_PREDICTING;


-- Training data
Create table STATION_ST_WTH_TRAINING as SELECT a.last_reported, a.STATIONID, a.TIME_INT, a.WEEKDAY_INT, a.TOTALDOCKS, a.AVAILABLEBIKES, a.STATUSVALUE, a.ACTIVITY, a.TRUACTIVITY, a.NOAVAILABLEBIKES, a.NOAVAILABLEDOCKS, a.AVG_TEMP, a.MIN_TEMP, a.MAX_TEMP, a.AVG_DEWPOINT, a.WIND_SPEED, a.WIND_DIRECTION, a.WIND_PERCENT, b.BOROUGHCODE, b.REGION_ID
    FROM Admin.STATION_STATUS_WEATHER a, Admin.STATION_INFO b
    WHERE a.STATIONID = b.STATION_ID and a.last_reported >= '16-AUG-17' and a.LAST_REPORTED < '28-AUG-17' and a.stationid = 266;

-- Validation data
Create table STATION_ST_WTH_VALIDATING as SELECT a.last_reported, a.STATIONID, a.TIME_INT, a.WEEKDAY_INT, a.TOTALDOCKS, a.AVAILABLEBIKES, a.STATUSVALUE, a.ACTIVITY, a.TRUACTIVITY, a.NOAVAILABLEBIKES, a.NOAVAILABLEDOCKS, a.AVG_TEMP, a.MIN_TEMP, a.MAX_TEMP, a.AVG_DEWPOINT, a.WIND_SPEED, a.WIND_DIRECTION, a.WIND_PERCENT, b.BOROUGHCODE, b.REGION_ID
    FROM Admin.Station_Status_weather a, Admin.Station_Info b
    WHERE a.STATIONID = b.STATION_ID and a.last_reported >= '28-AUG-17' and a.last_reported < '31-AUG-17' and a.stationid = 266;

-- Prediction data
Create table STATION_ST_WTH_PREDICTING as SELECT a.last_reported, a.STATIONID, a.TIME_INT, a.WEEKDAY_INT, a.TOTALDOCKS, a.STATUSVALUE, a.ACTIVITY, a.TRUACTIVITY, a.NOAVAILABLEBIKES, a.NOAVAILABLEDOCKS, a.AVG_TEMP, a.MIN_TEMP, a.MAX_TEMP, a.AVG_DEWPOINT, a.WIND_SPEED, a.WIND_DIRECTION, a.WIND_PERCENT, b.BOROUGHCODE, b.REGION_ID
    FROM Admin.Station_Status_weather a, Admin.Station_Info b
    where a.STATIONID = b.STATION_ID and a.last_reported >= '31-AUG-17' and a.stationid = 266;


