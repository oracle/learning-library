/*
Author: Ashwin Agarwal
Contributors: Tom McGinn, Suresh Mohan
Last updated: 26-Aug-2020
Version: 20.2.9
*/

"use strict";var showdown="https://oracle.github.io/learning-library/common/redwood-hol/js/showdown.min.js";const manifestFileName="manifest.json",expandText="Expand All Steps",collapseText="Collapse All Steps",copyButtonText="Copy",queryParam="lab",utmParams=[{url:"https://myservices.us.oraclecloud.com/mycloud/signup",inParam:"customTrackingParam",outParam:"sourceType"}],nav_param_name="nav";$.ajaxSetup({cache:!0}),$(document).ready(function(){let e;$.when($.getScript(showdown,function(){console.log("Showdown library loaded!")}),$.getJSON("manifest.json",function(t){void 0!==(e=t).workshoptitle&&(document.getElementsByClassName("hol-Header-logo")[0].innerText=e.workshoptitle),console.log("Manifest file loaded!")}).fail(function(){alert("manifest.json file was not loaded. The manifest file should be co-located with the index.html file. If the file is co-located, check that the json format of the file is correct.")})).done(function(){init();let t=setupTutorialNav(e),o=document.createElement("article");loadTutorial(o,t,e,toggleTutorialNav)})}),$(window).scroll(function(){$("#contentBox").height()>$("#leftNav-toc").height()?($("#leftNav-toc").addClass("scroll"),$(window).scrollTop()+$(window).height()>$("footer").offset().top?$("#leftNav-toc").css("max-height",$("footer").offset().top-$("#leftNav-toc").offset().top):$("#leftNav-toc").css("max-height",$(window).height()-$("#leftNav-toc").offset().top+$(window).scrollTop())):($("#leftNav-toc").removeClass("scroll"),$("#leftNav-toc").css("max-height",""));try{document.querySelector(".selected .active").getBoundingClientRect().y+document.querySelector(".selected .active").clientHeight>$(window).height()&&$(".selected .active")[0].scrollIntoView(!1)}catch(e){}});let init=()=>{$("#mySidenav")&&$("#mySidenav").remove(),$(".hol-Header-actions").prependTo(".hol-Header-wrap"),$('<div id="tutorial-title"></div>').appendTo(".hol-Header-logo")[0],$("#openNav").click(function(){let e=getParam("nav");e&&"open"!==e?"close"===e&&window.history.pushState("","",setParam(window.location.href,"nav","open")):window.history.pushState("","",setParam(window.location.href,"nav","close")),toggleTutorialNav()})},loadTutorial=(e,t,o,n=null)=>{$.get(t.filename,function(n){console.log(t.filename+" loaded!"),n=singlesource(n,t.type),n=convertBracketInsideCopyCode(n),n=addPathToImageSrc(n,t.filename),$(e).html(new showdown.Converter({tables:!0}).makeHtml(n)),e=renderVideos(e),e=updateH1Title(e),e=wrapSectionTag(e),e=wrapImgWithFigure(e),e=addPathToAllRelativeHref(e,t.filename),e=makeAnchorLinksWork(e),e=addTargetBlank(e),e=allowCodeCopy(e),e=injectUtmParams(e),updateHeadContent(t,o.workshoptitle)}).done(function(){$("main").html(e),setTimeout(setupContentNav,0),collapseSection($("#module-content h2:not(:eq(0))"),"none"),setupTocNav(),n&&n()}).fail(function(){alert(t.filename+" not found! Please check that the file is available in the location provided in the manifest file.")})},toggleTutorialNav=()=>{let e=getParam("nav");e&&"open"!==e?"close"===e&&($(".hol-Nav-list > li:not(.selected)").attr("tabindex","-1"),$("#leftNav-toc, #leftNav, #contentBox").addClass("close").removeClass("open")):($(".hol-Nav-list > li:not(.selected)").attr("tabindex","0"),$("#leftNav-toc, #leftNav, #contentBox").addClass("open").removeClass("close")),$(window).scroll()},setupTutorialNav=e=>{let t=$(document.createElement("div")).attr("id","leftNav-toc"),o=$(document.createElement("ul")).addClass("hol-Nav-list");return $(e.tutorials).each(function(e,t){let n=createShortNameFromTitle(t.title);$(document.createElement("li")).each(function(){$(this).click(function(){changeTutorial(n)}),$(this).attr("id",n),$(this).text(t.title),$(this).appendTo(o),$(this).keydown(function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),changeTutorial(n))})})}),$(o).appendTo(t),$(t).appendTo("#leftNav"),selectTutorial(e)},selectTutorial=e=>{$("#"+getParam("lab")).addClass("selected"),$(".selected").unbind("keydown");for(var t=0;t<e.tutorials.length;t++)if(getParam("lab")===createShortNameFromTitle(e.tutorials[t].title))return e.tutorials[t];return $(".hol-Nav-list").find("li:eq(0)").addClass("selected"),e.tutorials[0]},setupTocNav=()=>{$(".hol-Nav-list .selected").wrapInner("<div tabindex='0'></div>"),$(".hol-Nav-list .selected div").prepend($(document.createElement("div")).addClass("arrow").text("+")),$(".hol-Nav-list .selected").unbind("click"),$(".hol-Nav-list .selected > div").click(function(e){"-"===$(".selected div.arrow").text()?($("#toc").fadeOut("fast"),$(".selected div.arrow").text("+")):($("#toc").fadeIn("fast"),$(".selected div.arrow").text("-"))}),$(".hol-Nav-list .selected > div").keydown(function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),$(this).click())}),$(window).scroll(),$("#toc").appendTo(".hol-Nav-list .selected"),$(".selected div.arrow").click(),$("#toc").tocify({selectors:"h2"}).data("toc-tocify").setOptions({extendPage:!1,smoothScroll:!1,scrollTo:$(".hol-Header").height(),highlightDefault:!0,showEffect:"fadeIn",showAndHide:!1}),$(".tocify-item").each(function(){let e=$(this).attr("data-unique");if($(this)!==$(".tocify-item:eq(0)")&&$(this).click(function(t){expandSectionBasedOnHash(e)}),e===location.hash.slice(1)){let e=$(this);setTimeout(function(){$(e).click()},1e3)}})},changeTutorial=e=>location.href=unescape(setParam(window.location.href,"lab",e)),addPathToImageSrc=(e,t)=>{let o,n=new RegExp(/!\[.*?\]\((.*?)\)/g),a=[];t=t.replace(/\/[^\/]+$/,"/");do{if(null===(o=n.exec(e)))return $(a).each(function(t,o){e=e.replace(o.replace,o.with)}),e;1!==t.indexOf("/")&&(o[1]=o[1].split(" ")[0],-1===o[1].indexOf("http")&&a.push({replace:"("+o[1],with:"("+t+o[1]}))}while(o)},updateH1Title=e=>($("#tutorial-title").text("\t\t>\t\t"+$(e).find("h1").text()),e),wrapSectionTag=e=>($(e).find("h2").each(function(){$(this).nextUntil("h2").andSelf().wrapAll("<section></section>")}),e),wrapImgWithFigure=e=>($(e).find("img").on("load",function(){if($(this)[0].width>100||$(this)[0].height>100||void 0!==$(this).attr("title"))if($(this).wrap("<figure></figure>"),$.trim($(this).attr("title"))){let e=$(this).attr("src").split("/").pop().split(".").shift();$(this).parent().append('<figcaption><a href="files/'+e+'.txt">Description of illustration ['+e+"]</figcaption>")}else $(this).removeAttr("title")}),e),addPathToAllRelativeHref=(e,t)=>(-1!==t.indexOf("/")&&(t=t.replace(/\/[^\/]+$/,"/"),$(e).find("a").each(function(){-1===$(this).attr("href").indexOf("http")&&0!==$(this).attr("href").indexOf("?")&&0!==$(this).attr("href").indexOf("#")&&$(this).attr("href",t+$(this).attr("href"))})),e),makeAnchorLinksWork=e=>($(e).find('a[href^="#"]').each(function(){let e=$(this).attr("href");"#"!==e&&$(this).click(function(){expandSectionBasedOnHash(e.split("#")[1])})}),e),addTargetBlank=e=>($(e).find("a").each(function(){0===$(this).attr("href").indexOf("http")&&$(this).attr("target","_blank")}),e),updateHeadContent=(e,t)=>{document.title=void 0!==t?t+" | "+e.title:e.title;const o=[{name:"contentid",content:e.contentid},{name:"description",content:e.description},{name:"partnumber",content:e.partnumber},{name:"publisheddate",content:e.publisheddate}];$(o).each(function(e,t){if(t.content){let e=document.createElement("meta");$(e).attr(t).prependTo("head")}})},setupContentNav=()=>{$("#module-content h2:eq(1)").before('<button id="btn_toggle" class="hol-ToggleRegions plus">'+expandText+"</button>").prev().on("click",function(e){$(this).text()===expandText?expandSection($("#module-content h2:not(:eq(0))"),"show"):collapseSection($("#module-content h2:not(:eq(0))"),"hide"),changeButtonState()}),$("#module-content h2:not(:eq(0))").click(function(e){$(this).hasClass("plus")?expandSection(this,"fade"):collapseSection(this,"fade"),changeButtonState()}),$("#module-content h2:not(:eq(0))").attr("tabindex","0"),$("#module-content h2:not(:eq(0))").keydown(function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),$(this).hasClass("plus")?expandSection($(this),"fade"):collapseSection($(this),"fade"))}),window.scrollTo(0,0)},expandSection=(e,t)=>{"show"===t?$(e).nextUntil("#module-content h1, #module-content h2").show("fast"):"fade"===t&&$(e).nextUntil("#module-content h1, #module-content h2").fadeIn("fast"),$(e).addClass("minus"),$(e).removeClass("plus")},collapseSection=(e,t)=>{"hide"===t?$(e).nextUntil("#module-content h1, #module-content h2").hide("fast"):"fade"===t?$(e).nextUntil("#module-content h1, #module-content h2").fadeOut("fast"):"none"==t&&$(e).nextUntil("#module-content h1, #module-content h2").attr("style","display:none;"),$(e).addClass("plus"),$(e).removeClass("minus")},changeButtonState=()=>{$("#module-content h2.minus").length<=$("#module-content h2.plus").length?($("#btn_toggle").text(expandText),$("#btn_toggle").addClass("plus"),$("#btn_toggle").removeClass("minus")):($("#btn_toggle").text(collapseText),$("#btn_toggle").addClass("minus"),$("#btn_toggle").removeClass("plus"))},expandSectionBasedOnHash=e=>{let t=$('div[name="'+e+'"]').next();$(t).hasClass("hol-ToggleRegions")&&(t=$(t).next()),"H2"!==t[0].tagName&&(t=$(t).siblings("h2")),($(t).hasClass("minus")||$(t).hasClass("plus"))&&expandSection(t,"fade"),$(t)[0].scrollIntoView(),window.scrollTo(0,window.scrollY-$(".hol-Header").height()),changeButtonState()},allowCodeCopy=e=>($(e).find("pre code").each(function(){let e=$(document.createElement("code")).html($(this).text());$(e).has("copy").length&&($(e).find("copy").contents().unwrap().wrap('<span class="copy-code">'),$(this).html($(e).html()),$(this).before('<button class="copy-button" title="Copy text to clipboard">Copy</button>'))}),$(e).find(".copy-button").click(function(){let e=$(this).next().find(".copy-code").map(function(){return $(this).text().trim()}).get().join("\n"),t=$("<textarea>").val(e).appendTo(this).select();document.execCommand("copy"),$(t).remove(),$(this).parent().animate({opacity:.2}).animate({opacity:1})}),e),renderVideos=e=>($(e).find('a[href^="youtube:"]').each(function(){$(this).after('<div class="video-container"><iframe src="https://www.youtube.com/embed/'+$(this).attr("href").split(":")[1]+'" frameborder="0" allowfullscreen></div>'),$(this).remove()}),e),singlesource=(e,t)=>{let o,n=new RegExp(/<\s*if type="([^>]*)">([\s\S|\n]*?)<\/\s*if>/gm),a=[];"array"!==$.type(t)&&(t=Array(t));do{if(null===(o=n.exec(e)))return $(a).each(function(t,o){e=e.replace(o.replace,o.with)}),e;-1===$.inArray(o[1],t)?a.push({replace:o[0],with:""}):a.push({replace:o[0],with:o[2]})}while(o)},convertBracketInsideCopyCode=e=>{let t=new RegExp(/<copy>([\s\S|\n]*?)<\/copy>/gm);return e=e.replace(t,function(e){return"<copy>"+(e=(e=(e=(e=e.replace("<copy>","")).replace("</copy>","")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).trim()+"</copy>"})},injectUtmParams=e=>{window.location.href;return $(utmParams).each(function(t,o){let n=getParam(o.inParam);n&&$(e).find('a[href*="'+o.url+'"]').each(function(){let e=$(this).attr("href");$(this).attr("href",unescape(setParam(e,o.outParam,n)))})}),$(utmParams).each(function(t,o){let n=getParam(o.inParam);n&&$(e).find('a[href*="?lab="]').each(function(){let e=$(this).attr("href")+"&"+o.inParam+"="+n;$(this).attr("href",unescape(e))})}),e},setParam=(e,t,o)=>{let n=e.split("?")[0].split("#")[0],a=e.replace(n,"").split("#")[0],i=e.replace(n+a,"");i="";let l=getParam(t);return l?n+a.replace(t+"="+l,t+"="+o)+"":0===a.length||1===a.length?n+"?"+t+"="+o:n+a+"&"+t+"="+o},getParam=e=>{let t=window.location.search.substring(1).split("&");for(var o=0;o<t.length;o++)if(t[o].split("=")[0]==e)return t[o].split("=")[1];return!1},createShortNameFromTitle=e=>{if(!e)return alert("The title in the manifest file cannot be blank!"),"ErrorTitle";let t=e.toLowerCase().replace(/ /g,"-").trim().substr(0,50);return $.each(["<",">",":",'"',"/","\\\\","|","\\?","\\*","&"],function(e,o){t=t.replace(new RegExp(o,"g"),"")}),$.each(["-a-","-in-","-of-","-the-","-to-","-an-","-is-","-your-","-you-","-and-","-from-","-with-"],function(e,o){t=t.replace(new RegExp(o,"g"),"-")}),t.length>40&&(t=t.substr(0,t.lastIndexOf("-"))),t};